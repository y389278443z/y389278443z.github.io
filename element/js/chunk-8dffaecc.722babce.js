(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8dffaecc"],{"0c95":function(s,t,e){"use strict";e.r(t);var a=function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:s.loading,expression:"loading"}],staticClass:"height100"},[e("header-top",{attrs:{text:s.text}}),e("div",{staticClass:"verify-address baseBg flexAlign",on:{click:s.toAddressList}},[s.defaultAddress?e("div",{staticClass:"grow1 bfcHidden address-left"},[e("p",{staticClass:"marginB1"},[s._v("订单配送至"),e("span",{staticClass:"address-state"},[s._v(s._s(s.tagName(s.defaultAddress.tag_type)))])]),e("h2",{staticClass:"textEllipsis marginB1"},[s._v(s._s(s.defaultAddress.address)+"("+s._s(s.defaultAddress.address_detail)+")")]),e("p",[e("span",[s._v(s._s(s.defaultAddress.name))]),s._v("("),e("span",[s._v(s._s(1==s.defaultAddress.sex?"先生":"女士"))]),s._v(") "),e("span",[s._v(s._s(s.defaultAddress.phone))])])]):e("div",{staticClass:"grow1 f16"},[e("span",{staticClass:"el-icon-location-outline"}),s._v("请添加一个地址\n        ")]),e("span",{staticClass:"el-icon-arrow-right shrink0"})]),s.shopInfo?e("div",{staticClass:"confirm-info"},[e("div",{staticClass:"confirm-box"},[e("ul",[e("li",[e("div",[e("p",[s._v("送达时间")]),s.shopInfo.delivery_mode.text?e("span",{staticClass:"f12 state-text1 cfff"},[s._v(s._s(s.shopInfo.delivery_mode.text))]):s._e()]),e("div",{staticClass:"baseC"},[s._v("\n                        尽快送达 "),s.shopInfo.order_lead_time?e("span",[s._v("("+s._s(s.leadTime)+")送达")]):s._e()])]),s._m(0)])]),s.orderList?e("div",{staticClass:"confirm-box"},[e("ul",{staticClass:"order-list"},[e("li",[e("h3",[s._v("\n                        "+s._s(s.shopInfo.name)+"\n                    ")])]),s._l(s.orderList,function(t,a){return e("li",{key:a},[e("div",{staticClass:"flexAlign bfcHidden grow1"},[e("div",{staticClass:"bfcHidden grow1"},[e("p",{staticClass:"each-info textEllipsis"},[s._v(s._s(t.name))]),t.specs.length?e("p",[s._v(s._s(t.specs[0].name)+"："+s._s(t.specs[0].value))]):e("p",[s._v("规格：无")])]),e("span",{staticClass:"shrink0"},[s._v("× "+s._s(t.count))])]),e("span",{staticClass:"shrink0 marginL2"},[s._v("￥"+s._s((t.price*t.count).toFixed(2)))])])}),e("li",[e("span",[s._v("配送费")]),e("span",[s._v("￥"+s._s(s.shopInfo.float_delivery_fee||0))])]),s._m(1),e("li",[s._m(2),e("span",[s._v("小计 "),e("span",{staticClass:"f20"},[s._v("￥"+s._s(s.totalPrice()))])])])],2)]):s._e(),e("div",{staticClass:"confirm-box"},[e("ul",[e("li",{on:{click:s.toRemark}},[e("span",{staticClass:"shrink0 marginR2"},[s._v("订单备注")]),e("span",{staticClass:"c999 grow1 bfcHidden alignCenter"},[e("span",{staticClass:"grow1 bfcHidden textEllipsis tr"},[s._v(s._s(this.remarkInfo?this.remarkInfo.join(","):"口味、偏好"))]),e("span",{staticClass:"el-icon-arrow-right shrink0"})])]),e("li",[e("div",[e("p",{staticClass:"marginB1"},[s._v("号码保护"),e("span",{staticClass:"el-icon-question c999 f12",on:{click:function(t){s.hidePhone=!0}}})]),e("p",{staticClass:"c999 f12"},[s._v("号码保护中，将对商家、骑手隐藏您的真实手机号")])])])])])]):s._e(),e("div",{staticClass:"confirm-footer disFlex f16"},[e("p",{staticClass:"confirm-total grow1"},[s._v("￥"+s._s(s.totalPrice()))]),e("span",{staticClass:"confirm-btn shrink0 tc",on:{click:s.goPay}},[s._v("去支付")])]),e("transition",{attrs:{name:"moveleft"}},[e("router-view",{staticClass:"remark-box"})],1),e("transition",{attrs:{name:"moveleft"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:s.hidePhone,expression:"hidePhone"}],staticClass:"remark-box hide-box"},[e("h3",[s._v("服务介绍")]),e("p",[s._v("对骑手、商家隐藏您的真实手机号，保护您的隐私。")]),e("img",{staticClass:"img100",attrs:{src:"images/protect.png",alt:""}}),e("h3",[s._v("使用说明")]),e("p",[s._v("号码保护服务不会向您额外收费，费用由吃了吗承担。")]),e("p",{staticClass:"marginB4"},[s._v("当号码保护的服务提供商出现服务故障时，您的手机号码将会显示给商家和骑手，以确保商家和骑手能为你送餐。")]),e("el-button",{staticClass:"width100",attrs:{type:"primary"},on:{click:function(t){s.hidePhone=!1}}},[s._v("返回")])],1)])],1)},i=[function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("li",[e("p",[s._v("支付方式")]),e("p",{staticClass:"baseC"},[s._v("在线支付")])])},function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("li",[e("span",[s._v("红包")]),e("div",[e("span",[s._v("0个可用")]),e("span",{staticClass:"el-icon-arrow-right"})])])},function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("span",{staticClass:"c999"},[s._v("优惠说明"),e("span",{staticClass:"el-icon-question f12"})])}],n=e("a4bb"),r=e.n(n),o=(e("7f7f"),e("ac6a"),e("5d73")),c=e.n(o),l=e("f392"),d=e("ed08"),f=e("365c"),h="cart_list",p="shop_info",u="user_info",_="geo_hash",v={name:"confirmorder",components:{headerTop:l["a"]},data:function(){return{text:"确认订单",shopId:"",orderList:null,shopInfo:null,hidePhone:!1,userId:null,geohash:null,loading:!1}},created:function(){this.shopId=this.$route.params.id;var s=JSON.parse(Object(d["b"])(h)),t=JSON.parse(Object(d["b"])(p));this.geohash=Object(d["b"])(_);var e=JSON.parse(Object(d["b"])(u));e&&(this.userId=e.user_id);var a=!0,i=!1,n=void 0;try{for(var r,o=c()(t);!(a=(r=o.next()).done);a=!0){var l=r.value;if(l.id==this.shopId){this.shopInfo=l;break}}}catch(v){i=!0,n=v}finally{try{a||null==o.return||o.return()}finally{if(i)throw n}}if(s)for(var f in s)f==this.shopId&&(this.orderList=s[f])},methods:{tagName:function(s){return 1==s?"家":2==s?"公司":3==s?"学校":void 0},goPay:function(){var s=this;if(this.defaultAddress)if(this.orderList){var t=[];this.orderList.forEach(function(s){t.push({id:s.food_id,name:s.name,packing_fee:s.packing_fee,price:s.price,count:s.count,sku_id:s.sku_id,specs:[s.specs],stock:s.stock})}),this.loading=!0;var e=this.defaultAddress.address+"("+this.defaultAddress.address_detail+")",a=this.shopInfo.name,i=this.shopInfo.image_path;Object(f["b"])(this.userId,this.shopId,a,i,e,t).then(function(t){if(t.status>0){var e=JSON.parse(Object(d["b"])(h));delete e[s.shopId],0==r()(e).length?Object(d["e"])(h):Object(d["f"])(h,e),s.$alert({message:t.message,type:"success",success:function(){s.$router.push({name:"pay",params:{restaurant_id:s.shopId}})}})}else s.$alert({message:t.message,type:"error"});s.loading=!1}).catch(function(t){s.loading=!1,s.$alert({message:t,type:"error"})})}else this.$msg({text:"选择商品为空，请重新选择！"});else this.$msg({text:"请选择一个地址！"})},totalPrice:function(){var s=0;return this.orderList&&(this.orderList.forEach(function(t){s+=t.price*t.count}),this.shopInfo.float_delivery_fee&&(s+=this.shopInfo.float_delivery_fee)),s.toFixed(2)},toRemark:function(){this.$router.push({name:"remark"})},toAddressList:function(){this.$router.push({name:"caddress"})}},computed:{remarkInfo:function(){return this.$store.getters.remarkInfo},leadTime:function(){var s=(new Date).getTime(),t=this.shopInfo.order_lead_time||0;return t?(s+=60*t*1e3,Object(d["a"])(s,"hh:mm")):""},defaultAddress:function(){return this.$store.getters.defaultAddress}}},m=v,g=(e("2b9c"),e("2877")),b=Object(g["a"])(m,a,i,!1,null,"fbabdca6",null);t["default"]=b.exports},"2b9c":function(s,t,e){"use strict";var a=e("82c1"),i=e.n(a);i.a},"469f":function(s,t,e){e("6c1c"),e("1654"),s.exports=e("7d7b")},"5d73":function(s,t,e){s.exports=e("469f")},"7d7b":function(s,t,e){var a=e("e4ae"),i=e("7cd6");s.exports=e("584a").getIterator=function(s){var t=i(s);if("function"!=typeof t)throw TypeError(s+" is not iterable!");return a(t.call(s))}},"82c1":function(s,t,e){},f392:function(s,t,e){"use strict";var a=function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("div",{staticClass:"yz-header baseBg",class:{fixed:s.fixed}},[e("div",{staticClass:"lc-header"},[e("span",{staticClass:"el-icon-arrow-left header-left-icon",on:{click:s.back}}),e("span",[s._v(s._s(s.text))])])])},i=[],n={name:"headerTop",props:{text:{},fixed:{default:!1}},methods:{back:function(){this.$router.back(-1)}}},r=n,o=e("2877"),c=Object(o["a"])(r,a,i,!1,null,"583480de",null);t["a"]=c.exports}}]);